import{_ as K}from"./preload-helper.41c905a7.js";import{w as L,d as j}from"./index.7205af7a.js";import{w as d}from"./scheduler.d111044b.js";var se=Object.defineProperty,ne=Object.defineProperties,ce=Object.getOwnPropertyDescriptors,D=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,M=(r,a,e)=>a in r?se(r,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[a]=e,u=(r,a)=>{for(var e in a||(a={}))G.call(a,e)&&M(r,e,a[e]);if(D)for(var e of D(a))J.call(a,e)&&M(r,e,a[e]);return r},g=(r,a)=>ne(r,ce(a)),P=(r,a)=>{var e={};for(var t in r)G.call(r,t)&&a.indexOf(t)<0&&(e[t]=r[t]);if(r!=null&&D)for(var t of D(r))a.indexOf(t)<0&&J.call(r,t)&&(e[t]=r[t]);return e},_=["error","warn","debug"],Q=({logger:r=console,level:a=_[1],prefix:e="[i18n]: "})=>_.reduce((t,i,l)=>g(u({},t),{[i]:o=>_.indexOf(a)>=l&&r[i](`${e}${o}`)}),{}),p=Q({}),ue=r=>{p=r},z=r=>{var a=r,{parser:e,key:t,params:i,translations:l,locale:o,fallbackLocale:s}=a,c=P(a,["parser","key","params","translations","locale","fallbackLocale"]);if(!t)return p.warn(`No translation key provided ('${o}' locale). Skipping translation...`),"";if(!o)return p.warn(`No locale provided for '${t}' key. Skipping translation...`),"";let n=(l[o]||{})[t];return s&&n===void 0&&(n=(l[s]||{})[t]),c.hasOwnProperty("fallbackValue")&&n===void 0?c.fallbackValue:e.parse(n,i,o,t)},b=(...r)=>r.length?r.filter(a=>!!a).map(a=>{let e=`${a}`.toLowerCase();try{let[t]=Intl.Collator.supportedLocalesOf(a);if(!t)throw new Error;e=t}catch{p.warn(`'${a}' locale is non-standard.`)}return e}):[],E=(r,a,e)=>Object.keys(r||{}).reduce((t,i)=>{let l=r[i],o=e?`${e}.${i}`:`${i}`;return a&&Array.isArray(l)?g(u({},t),{[o]:l.map(s=>E(s,a))}):l&&typeof l=="object"?u(u({},t),E(l,a,o)):g(u({},t),{[o]:l})},{}),de=r=>r.reduce((a,{key:e,data:t,locale:i})=>{if(!t)return a;let[l]=b(i),o=g(u({},a[l]||{}),{[e]:t});return g(u({},a),{[l]:o})},{}),pe=async r=>{try{let a=await Promise.all(r.map(e=>{var t=e,{loader:i}=t,l=P(t,["loader"]);return new Promise(async o=>{let s;try{s=await i()}catch(c){p.error(`Failed to load translation. Verify your '${l.locale}' > '${l.key}' Loader.`),p.error(c)}o(g(u({loader:i},l),{data:s}))})}));return de(a)}catch(a){p.error(a)}return{}},fe=r=>a=>{try{if(typeof a=="string")return a===r;if(typeof a=="object")return a.test(r)}catch{p.error("Invalid route config!")}return!1},he=(r,a)=>{let e=!0;try{e=Object.keys(r).filter(t=>r[t]!==void 0).every(t=>r[t]===a[t])}catch{}return e},H=1e3*60*60*24,me=class{constructor(a){this.cachedAt=0,this.loadedKeys={},this.currentRoute=L(),this.config=L(),this.isLoading=L(!1),this.promises=new Set,this.loading={subscribe:this.isLoading.subscribe,toPromise:(e,t)=>{let i=Array.from(this.promises).filter(l=>he({locale:b(e)[0],route:t},l)).map(({promise:l})=>l);return Promise.all(i)},get:()=>d(this.isLoading)},this.privateRawTranslations=L({}),this.rawTranslations={subscribe:this.privateRawTranslations.subscribe,get:()=>d(this.rawTranslations)},this.privateTranslations=L({}),this.translations={subscribe:this.privateTranslations.subscribe,get:()=>d(this.translations)},this.locales=g(u({},j([this.config,this.privateTranslations],([e,t])=>{if(!e)return[];let{loaders:i=[]}=e,l=i.map(({locale:s})=>s),o=Object.keys(t).map(s=>s);return Array.from(new Set([...b(...l),...b(...o)]))},[])),{get:()=>d(this.locales)}),this.internalLocale=L(),this.loaderTrigger=j([this.internalLocale,this.currentRoute],([e,t],i)=>{var l,o;e!==void 0&&t!==void 0&&!(e===((l=d(this.loaderTrigger))==null?void 0:l[0])&&t===((o=d(this.loaderTrigger))==null?void 0:o[1]))&&(p.debug("Triggering translation load..."),i([e,t]))},[]),this.localeHelper=L(),this.locale={subscribe:this.localeHelper.subscribe,forceSet:this.localeHelper.set,set:this.internalLocale.set,update:this.internalLocale.update,get:()=>d(this.locale)},this.initialized=j([this.locale,this.currentRoute,this.privateTranslations],([e,t,i],l)=>{d(this.initialized)||l(e!==void 0&&t!==void 0&&!!Object.keys(i).length)}),this.translation=j([this.privateTranslations,this.locale,this.isLoading],([e,t,i],l)=>{let o=e[t];o&&Object.keys(o).length&&!i&&l(o)},{}),this.t=g(u({},j([this.config,this.translation],e=>{var[t]=e,i=t,{parser:l,fallbackLocale:o}=i,s=P(i,["parser","fallbackLocale"]);return(c,...n)=>z(u({parser:l,key:c,params:n,translations:this.translations.get(),locale:this.locale.get(),fallbackLocale:o},s.hasOwnProperty("fallbackValue")?{fallbackValue:s.fallbackValue}:{}))})),{get:(e,...t)=>d(this.t)(e,...t)}),this.l=g(u({},j([this.config,this.translations],e=>{var[t,...i]=e,l=t,{parser:o,fallbackLocale:s}=l,c=P(l,["parser","fallbackLocale"]),[n]=i;return(f,h,...O)=>z(u({parser:o,key:h,params:O,translations:n,locale:f,fallbackLocale:s},c.hasOwnProperty("fallbackValue")?{fallbackValue:c.fallbackValue}:{}))})),{get:(e,t,...i)=>d(this.l)(e,t,...i)}),this.getLocale=e=>{let{fallbackLocale:t=""}=d(this.config)||{},i=e||t;if(!i)return"";let l=this.locales.get();return l.find(o=>b(i).includes(o))||l.find(o=>b(t).includes(o))||""},this.setLocale=e=>{if(e&&e!==d(this.internalLocale))return p.debug(`Setting '${e}' locale.`),this.internalLocale.set(e),this.loading.toPromise(e,d(this.currentRoute))},this.setRoute=e=>{if(e!==d(this.currentRoute)){p.debug(`Setting '${e}' route.`),this.currentRoute.set(e);let t=d(this.internalLocale);return this.loading.toPromise(t,e)}},this.loadConfig=async e=>{await this.configLoader(e)},this.getTranslationProps=async(e=this.locale.get(),t=d(this.currentRoute))=>{let i=d(this.config);if(!i||!e)return[];let l=this.translations.get(),{loaders:o,fallbackLocale:s="",cache:c=H}=i||{},n=Number.isNaN(+c)?H:+c;this.cachedAt?Date.now()>n+this.cachedAt&&(p.debug("Refreshing cache."),this.loadedKeys={},this.cachedAt=0):(p.debug("Setting cache timestamp."),this.cachedAt=Date.now());let[f,h]=b(e,s),O=l[f],V=l[h],$=(o||[]).map(m=>{var y=m,{locale:R}=y,v=P(y,["locale"]);return g(u({},v),{locale:b(R)[0]})}).filter(({routes:m})=>!m||(m||[]).some(fe(t))).filter(({key:m,locale:y})=>y===f&&(!O||!(this.loadedKeys[f]||[]).includes(m))||s&&y===h&&(!V||!(this.loadedKeys[h]||[]).includes(m)));if($.length){this.isLoading.set(!0),p.debug("Fetching translations...");let m=await pe($);this.isLoading.set(!1);let y=Object.keys(m).reduce((v,k)=>g(u({},v),{[k]:Object.keys(m[k])}),{}),R=$.filter(({key:v,locale:k})=>(y[k]||[]).some(x=>`${x}`.startsWith(v))).reduce((v,{key:k,locale:x})=>g(u({},v),{[x]:[...v[x]||[],k]}),{});return[m,R]}return[]},this.addTranslations=(e,t)=>{if(!e)return;let i=d(this.config),{preprocess:l}=i||{};p.debug("Adding translations...");let o=Object.keys(e||{});this.privateRawTranslations.update(s=>o.reduce((c,n)=>g(u({},c),{[n]:u(u({},c[n]||{}),e[n])}),s)),this.privateTranslations.update(s=>o.reduce((c,n)=>{let f=!0,h=e[n];return typeof l=="function"&&(h=l(h)),(typeof l=="function"||l==="none")&&(f=!1),g(u({},c),{[n]:u(u({},c[n]||{}),f?E(h,l==="preserveArrays"):h)})},s)),o.forEach(s=>{let c=Object.keys(e[s]).map(n=>`${n}`.split(".")[0]);t&&(c=t[s]),this.loadedKeys[s]=Array.from(new Set([...this.loadedKeys[s]||[],...c||[]]))})},this.loader=async([e,t])=>{let i=this.getLocale(e)||void 0;p.debug(`Adding loader promise for '${i}' locale and '${t}' route.`);let l=(async()=>{let o=await this.getTranslationProps(i,t);o.length&&this.addTranslations(...o)})();this.promises.add({locale:i,route:t,promise:l}),l.then(()=>{i&&this.locale.get()!==i&&this.locale.forceSet(i)})},this.loadTranslations=(e,t=d(this.currentRoute)||"")=>{let i=this.getLocale(e);if(i)return this.setRoute(t),this.setLocale(i),this.loading.toPromise(i,t)},this.loaderTrigger.subscribe(this.loader),this.isLoading.subscribe(async e=>{e&&this.promises.size&&(await this.loading.toPromise(),this.promises.clear(),p.debug("Loader promises have been purged."))}),a&&this.loadConfig(a)}async configLoader(a){if(!a)return p.error("No config provided!");let e=a,{initLocale:t,fallbackLocale:i,translations:l,log:o}=e,s=P(e,["initLocale","fallbackLocale","translations","log"]);o&&ue(Q(o)),[t]=b(t),[i]=b(i),p.debug("Setting config."),this.config.set(u({initLocale:t,fallbackLocale:i,translations:l},s)),l&&this.addTranslations(l),await this.loadTranslations(t)}},U=Object.defineProperty,ge=Object.defineProperties,ve=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable,q=(r,a,e)=>a in r?U(r,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[a]=e,w=(r,a)=>{for(var e in a||(a={}))X.call(a,e)&&q(r,e,a[e]);if(S)for(var e of S(a))Y.call(a,e)&&q(r,e,a[e]);return r},Z=(r,a)=>ge(r,ve(a)),T=(r,a)=>{var e={};for(var t in r)X.call(r,t)&&a.indexOf(t)<0&&(e[t]=r[t]);if(r!=null&&S)for(var t of S(r))a.indexOf(t)<0&&Y.call(r,t)&&(e[t]=r[t]);return e},ye=(r,a)=>{for(var e in a)U(r,e,{get:a[e],enumerable:!0})},ee={};ye(ee,{ago:()=>Pe,date:()=>we,eq:()=>N,gt:()=>te,gte:()=>Oe,lt:()=>ae,lte:()=>ke,ne:()=>be,number:()=>$e});var F=(r,a)=>{let{modifierDefaults:e}=a||{},{[r]:t}=e||{};return t||{}},N=({value:r,options:a=[],defaultValue:e=""})=>(a.find(({key:t})=>`${t}`.toLowerCase()===`${r}`.toLowerCase())||{}).value||e,be=({value:r,options:a=[],defaultValue:e=""})=>(a.find(({key:t})=>`${t}`.toLowerCase()!==`${r}`.toLowerCase())||{}).value||e,ae=({value:r,options:a=[],defaultValue:e=""})=>(a.sort((t,i)=>+t.key-+i.key).find(({key:t})=>+r<+t)||{}).value||e,te=({value:r,options:a=[],defaultValue:e=""})=>(a.sort((t,i)=>+i.key-+t.key).find(({key:t})=>+r>+t)||{}).value||e,ke=({value:r,options:a=[],defaultValue:e=""})=>N({value:r,options:a,defaultValue:ae({value:r,options:a,defaultValue:e})}),Oe=({value:r,options:a=[],defaultValue:e=""})=>N({value:r,options:a,defaultValue:te({value:r,options:a,defaultValue:e})}),$e=({value:r,props:a,defaultValue:e="",locale:t="",parserOptions:i})=>{if(!t)return"";let l=F("number",i),{maximumFractionDigits:o}=l,s=T(l,["maximumFractionDigits"]),c=(a==null?void 0:a.number)||{},{maximumFractionDigits:n=o||2}=c,f=T(c,["maximumFractionDigits"]);return new Intl.NumberFormat(t,w(Z(w({},s),{maximumFractionDigits:n}),f)).format(+r||+e)},we=({value:r,props:a,defaultValue:e="",locale:t="",parserOptions:i})=>{if(!t)return"";let l=T(F("date",i),[]),o=T((a==null?void 0:a.date)||{},[]);return new Intl.DateTimeFormat(t,w(w({},l),o)).format(+r||+e)},I=[{key:"second",multiplier:1e3},{key:"minute",multiplier:60},{key:"hour",multiplier:60},{key:"day",multiplier:24},{key:"week",multiplier:7},{key:"month",multiplier:13/3},{key:"year",multiplier:12}],re=(r="",a="")=>new RegExp(`^${r}s?$`).test(a),Le=r=>I.indexOf(I.find(({key:a})=>re(a,r))),je=(r,a)=>I.reduce(([e,t],{key:i,multiplier:l},o)=>{if(re(t,a))return[e,t];if(!t||o===Le(t)+1){let s=Math.round(e/l);if(!t||Math.abs(s)>=1||a!=="auto")return[s,i]}return[e,t]},[r,""]),Pe=({value:r,defaultValue:a="",locale:e="",props:t,parserOptions:i})=>{if(!e)return"";let l=F("ago",i),{format:o,numeric:s}=l,c=T(l,["format","numeric"]),n=(t==null?void 0:t.ago)||{},{format:f=o||"auto",numeric:h=s||"auto"}=n,O=T(n,["format","numeric"]),V=+r||+a,$=je(V,f);return new Intl.RelativeTimeFormat(e,w(Z(w({},c),{numeric:h}),O)).format(...$)},Te=r=>typeof r=="string"&&/{{(?:(?!{{|}}).)+}}/.test(r),C=r=>typeof r=="string"?r.replace(/\\(?=:|;|{|})/g,""):r,Ve=({value:r,props:a,payload:e,parserOptions:t,locale:i})=>`${r}`.replace(/{{\s*(?:(?!{{|}}).)+\s*}}/g,l=>{let o=C(`${l.match(/(?!{|\s).+?(?!\\[:;]).(?=\s*(?:[:;]|}}$))/)}`),s=e==null?void 0:e[o],[,c=""]=l.match(/.+?(?!\\;).;\s*default\s*:\s*([^\s:;].+?(?:\\[:;]|[^;}])*)(?=\s*(?:;|}}$))/i)||[];c=c||(e==null?void 0:e.default)||"";let[,n=""]=l.match(/{{\s*(?:[^;]|(?:\\;))+\s*(?:(?!\\:).[:])\s*(?!\s)((?:\\;|[^;])+?)(?=\s*(?:[;]|}}$))/i)||[];if(s===void 0&&n!=="ne")return c;let f=!!n,{customModifiers:h}=t||{},O=w(w({},ee),h||{});n=Object.keys(O).includes(n)?n:"eq";let V=O[n],$=(l.match(/[^\s:;{](?:[^;]|\\[;])+[^:;}]/gi)||[]).reduce((m,y,R)=>{if(R>0){let v=C(`${y.match(/(?:(?:\\:)|[^:])+/)}`.trim()),k=`${y.match(/(?:(?:\\:)|[^:])+$/)}`.trimStart();if(v&&v!=="default"&&k)return[...m,{key:v,value:k}]}return m},[]);return!f&&!$.length?s:V({value:s,options:$,props:a,defaultValue:c,locale:i,parserOptions:t})}),le=({value:r,props:a,payload:e,parserOptions:t,locale:i})=>{if(Te(r)){let l=Ve({value:r,payload:e,props:a,parserOptions:t,locale:i});return le({value:l,payload:e,props:a,parserOptions:t,locale:i})}else return C(r)},Re=r=>({parse:(a,[e,t],i,l)=>(e!=null&&e.default&&a===void 0&&(a=e.default),a===void 0&&(a=l),le({value:a,payload:e,props:t,parserOptions:r,locale:i}))}),xe=Re,De=Object.defineProperty,Se=Object.defineProperties,Ae=Object.getOwnPropertyDescriptors,A=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable,W=(r,a,e)=>a in r?De(r,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[a]=e,_e=(r,a)=>{for(var e in a||(a={}))ie.call(a,e)&&W(r,e,a[e]);if(A)for(var e of A(a))oe.call(a,e)&&W(r,e,a[e]);return r},Ee=(r,a)=>Se(r,Ae(a)),Ie=(r,a)=>{var e={};for(var t in r)ie.call(r,t)&&a.indexOf(t)<0&&(e[t]=r[t]);if(r!=null&&A)for(var t of A(r))a.indexOf(t)<0&&oe.call(r,t)&&(e[t]=r[t]);return e},B=r=>{var a=r,{parserOptions:e={}}=a,t=Ie(a,["parserOptions"]);return Ee(_e({},t),{parser:xe(e)})},Ce=class extends me{constructor(a){super(a&&B(a)),this.loadConfig=e=>super.configLoader(B(e))}},Fe=Ce;const Ne={loaders:[{locale:"en",key:"common",loader:async()=>(await K(()=>import("./en.0a25ce63.js"),[],import.meta.url)).default},{locale:"si",key:"common",loader:async()=>(await K(()=>import("./si.5990512c.js"),[],import.meta.url)).default}],fallbackValue:void 0},{t:Ke,locale:Be,locales:Ge,loading:Je,setLocale:Qe,setRoute:Ue,translations:Xe}=new Fe(Ne),Ye=j(Ke,r=>a=>{const e=r(`common.${a}`);return e||a});export{Ue as a,Be as l,Qe as s,Ye as t};
